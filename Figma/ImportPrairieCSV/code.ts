async function loadFonts() {

  await figma.loadFontAsync({ family: "Inter", style: "Regular" });
  console.log("Awaiting the fonts.");
};


var lightBaseMap = new Map();
var pathList = [];

function buildMaps() {

  var csvData = loadBaseData();
  console.log(`csvData() ${csvData}`);

  var rows = csvData.split("\n");
  console.log(`buildMap() found ${rows.length} base rows`);
  for (var i=0;i<rows.length;i++)
  {
    if (i > 0)
    {
      rows[i] = rows[i].trim();
      var cols = rows[i].split(",");
      lightBaseMap.set(cols[0], cols);
    }
  }

  var pathData = loadPathData();
  console.log(`pathData() ${pathData}`);

  rows = pathData.split("\n");
  console.log(`buildMap() found ${rows.length} path rows`);
  for (var i=0;i<rows.length;i++)
  {
    if (i > 0)
    {
      // store them as strings.   typescript doesnt' like arrays of arrays
      rows[i] = rows[i].trim();
      pathList.push(rows[i]);
    }
  }
}

function loadBaseData()
{
  var baseData = `BaseId,x,z,DistFromCtr,Theta,ChannelStart,PathId
        0,180.0005,0,180.0005,90,85,20
1,164.4387,73.21281,180.0005,66,64,20
2,120.4439,133.7664,180.0005,42,43,20
3,55.62321,171.1907,180.0005,18,22,20
4,-18.81519,179.0145,180.0005,5.999989,1,20
5,-90.00026,155.885,180.0005,30,484,20
6,-145.6235,105.8016,180.0005,54.00001,274,20
7,-176.0671,37.42421,180.0005,78,253,20
8,-176.0671,-37.42423,180.0005,102,232,20
9,-145.6235,-105.8017,180.0005,126,211,20
10,-90.00022,-155.885,180.0005,150,190,20
11,-18.81516,-179.0145,180.0005,174,169,20
12,55.62324,-171.1907,180.0005,162,148,20
13,120.4439,-133.7664,180.0005,138,127,20
14,164.4387,-73.2128,180.0005,114,106,20
15,-226.6911,466.6918,518.8353,25.90773,43,7
16,-238.4376,540.8561,591.0818,23.79038,295,6
17,-272.5272,607.7607,666.0662,24.15205,85,5
18,-325.623,660.8564,736.7234,26.23079,400,4
19,-392.5275,694.946,798.1403,29.45914,253,3
20,-466.6918,706.6924,846.8857,33.44033,127,2
21,-540.8561,694.946,880.6108,37.89257,1,1
22,-607.7607,660.8564,897.8331,42.60339,169,9
23,-660.8564,607.7607,897.8331,47.39661,295,10
24,-694.946,540.856,880.6107,52.10743,421,11
25,-706.6924,466.6917,846.8857,56.55968,85,12
26,-694.946,392.5274,798.1402,60.54087,274,13
27,-660.8563,325.6228,736.7233,63.76921,1,14
28,-607.7607,272.527,666.066,65.84798,253,15
29,-540.8558,238.4375,591.0817,66.20961,43,16
30,-466.6916,226.6911,518.8351,64.09227,379,17
31,-392.5273,238.4377,459.2713,58.72373,295,8
32,-325.6227,272.5273,424.619,50.07263,421,20
33,-272.5269,325.6232,424.6191,39.9273,64,19
34,-238.4375,392.5279,459.2718,31.27621,253,18
35,706.6927,-466.6917,846.8859,123.4403,43,28
36,694.946,-392.5274,798.1402,119.4591,22,28
37,660.8567,-325.6228,736.7237,116.2308,64,35
38,607.7609,-272.5269,666.0663,114.152,211,29
39,540.8562,-238.4374,591.0819,113.7904,295,34
40,466.692,-226.6909,518.8354,115.9077,1,33
41,392.5276,-238.4374,459.2716,121.2762,148,32
42,325.6231,-272.5269,424.619,129.9273,274,31
43,272.5273,-325.6228,424.619,140.0726,442,30
44,238.4377,-392.5274,459.2715,148.7237,295,21
45,226.6913,-466.6917,518.8353,154.0923,232,22
46,238.4377,-540.856,591.0818,156.2096,106,23
47,272.5273,-607.7607,666.0662,155.8479,400,24
48,325.6233,-660.8563,736.7235,153.7692,64,25
49,392.5279,-694.946,798.1404,150.5408,211,26
50,466.6922,-706.6924,846.8859,146.5597,358,27
51,540.8564,-694.9457,880.6107,142.1074,379,27
52,607.7611,-660.856,897.8331,137.3966,400,27
53,660.8567,-607.7603,897.833,132.6034,85,28
54,694.9464,-540.8555,880.6107,127.8925,64,28
55,-79.563,-221.2083,235.0817,160.2176,400,21
56,211.9864,111.4153,239.482,62.2746,1,30
57,-235.766,62.14796,243.8196,75.23273,337,8
58,134.18,-208.6821,248.0977,147.2595,337,21
59,42.73764,248.6739,252.3197,9.751711,127,19
60,-202.7859,-157.0479,256.4881,127.7561,421,21
61,259.7158,-21.51759,260.6056,94.73617,484,30
62,-179.7346,194.2888,264.6747,42.7716,463,20
63,1.310174,-268.6944,268.6976,179.7209,379,21
64,183.2076,201.9588,272.6764,42.21285,22,30
65,-275.4326,-25.52649,276.6129,95.29492,442,17
66,223.4419,-169.5851,280.5092,127.1973,463,30
67,-50.89652,279.7749,284.3668,10.31046,106,19
68,-153.4906,-243.9111,288.1874,147.8182,316,22
69,281.5891,77.17149,291.9724,74.67399,358,31
70,-263.1007,135.0193,295.7232,62.83379,316,8
71,104.0905,-280.7672,299.4413,159.6584,358,21
72,114.2924,280.7556,303.1277,22.15067,148,19
73,-277.2271,-131.3828,306.7838,115.3571,358,8
74,296.6322,-91.45506,310.4105,107.1351,316,31
75,-158.7699,270.913,314.0091,30.37265,85,19
76,-66.67687,-310.5021,317.5805,167.8804,295,22
77,261.7967,185.968,321.1255,54.61181,379,31
78,-322.153,40.14931,324.6452,82.89597,421,17
79,212.6906,-249.8776,328.1404,139.5963,316,21
80,12.08492,331.3916,331.6119,2.088535,295,18
81,-235.1816,-238.6527,335.0605,135.4197,442,21
82,338.045,17.28725,338.4868,87.07251,337,31
83,-263.5661,217.7677,341.8916,50.43526,442,20
84,47.71314,-341.9631,345.2757,172.0569,274,22
85,197.7182,287.1534,348.6396,34.54919,43,30
86,-343.0209,-78.92597,351.9839,102.9577,463,17
87,309.14,-175.1489,355.3092,119.5345,295,31
88,-110.6593,341.116,358.6162,17.97325,274,18
89,-150.1887,-329.2701,361.9052,155.481,337,22
90,336.1752,142.6203,365.1771,67.01121,232,32
91,-347.2917,123.0059,368.4318,70.49657,400,17
92,174.5135,-328.1523,371.6704,151.9957,253,22
93,93.78896,362.9716,374.893,14.48788,316,18
94,-317.03,-206.0382,378.1002,123.0199,379,8
95,376.0935,-62.74982,381.2924,99.47234,190,32
96,-30.12191,-386.461,387.6331,175.5432,148,23
97,285.563,266.7672,390.7824,46.94902,400,31
98,-393.8996,-3.841461,393.9184,90.55875,85,16
99,-38.86926,398.2589,400.1512,5.574326,64,7
100,-242.2195,-322.396,403.2486,143.0821,463,21
101,399.4133,74.6749,406.334,79.41016,211,32
102,110.9586,-397.2648,412.4696,164.3946,127,23
103,187.9106,370.6031,415.5203,26.88684,169,19
104,-391.7433,-147.41,418.5601,110.6209,484,17
105,391.2444,-157.0516,421.5891,111.8713,169,32
106,-123.993,-409.2449,427.6162,163.1442,358,22
107,370.4489,219.5372,430.6147,59.34797,253,32
108,-424.3779,88.96801,433.6034,78.1598,64,16
109,52.23264,436.4384,439.5528,6.82464,337,18
110,-335.57,-288.4638,442.5139,130.6831,400,8
111,445.244,-14.06325,445.466,91.80911,43,33
112,25.24534,-450.6384,451.345,176.7936,169,23
113,287.64,351.6051,454.2719,39.28581,421,31
114,-452.4916,-65.38221,457.1909,98.22198,106,16
115,-106.0229,450.703,463.0055,13.23752,316,6
116,-227.6827,-406.4784,465.9014,150.7453,484,21
117,445.2016,146.8319,468.79,71.74693,64,33
118,157.1912,450.7934,477.4136,19.22361,190,19
119,-422.9338,-227.5756,480.2745,118.2842,1,17
120,468.3504,-118.5811,483.1289,104.2081,22,33
121,-78.08997,-482.5409,488.8187,170.8075,379,22
122,385.7577,304.8198,491.6544,51.68475,274,32
123,-493.1707,36.01698,494.4842,85.82302,295,15
124,-7.327084,500.0723,500.126,0.8395343,85,7
125,-334.2603,-375.7887,502.9384,138.3472,421,8
126,503.1073,51.59161,505.7456,84.14501,337,34
127,96.43449,-502.1681,511.3437,169.1295,190,23
128,269.5653,437.8007,514.1351,31.6217,64,30
129,-497.1791,-141.4946,516.9214,105.8861,127,16
130,-193.2928,-488.3924,525.2516,158.4077,1,21
131,474.9214,230.7674,528.0189,64.08458,85,33
132,-508.7216,151.4323,530.7819,73.42319,274,15
133,107.4818,525.4138,536.2947,11.56127,358,18
134,-436.3921,-316.4353,539.0448,125.9465,22,17
135,538.2589,-61.76198,541.7907,96.54572,316,34
136,-14.61399,-547.0754,547.2706,178.4698,400,22
137,382.2202,395.491,550.0049,44.0224,442,31
138,-551.7129,-33.60282,552.7353,93.48537,316,15
139,-82.51388,552.0528,558.1853,8.500919,337,6
140,-313.5836,-465.059,560.9051,146.0087,442,8
141,548.0105,131.7322,563.6212,76.48354,358,34
142,232.1892,522.4814,571.7505,23.96022,211,19
143,-526.6182,-229.5,574.4537,113.5476,148,16
144,-140.2313,-565.4155,582.5457,166.0709,22,21
145,487.5772,323.6837,585.2372,56.42136,295,32
146,-580.8258,91.09596,587.9261,81.08642,22,14
147,40.3329,591.923,593.2955,3.898074,106,7
148,-431.5194,-411.0702,595.9763,133.6097,43,17
149,598.5408,11.67551,598.6546,88.88249,253,29
150,64.53033,-600.5469,604.0039,173.8669,421,22
151,359.6642,488.5652,606.6748,36.35917,85,30
152,-597.845,-117.8192,609.3439,101.1486,337,15
153,-171.1193,590.3754,614.6747,16.16414,106,5
154,-273.7954,-553.3,617.3369,153.6719,463,8
155,578.1176,224.0012,619.9971,68.82032,106,33
156,176.2175,602.7342,627.9658,16.29699,379,18
157,-539.3469,-326.7788,630.6183,121.2108,169,16
158,621.033,-123.8856,633.269,101.2815,232,29
159,-69.69477,-634.7502,638.5649,173.7341,43,21
160,482.1475,422.711,641.2104,48.75813,463,31
161,-643.701,14.04966,643.8544,88.74964,43,14
162,-42.62729,647.7364,649.1375,3.7652,358,6
163,-407.7587,-508.4741,651.7769,141.273,64,17
164,646.7449,99.89867,654.4147,81.21927,379,34
165,157.3156,-640.6542,659.6863,166.2037,211,23
166,318.0207,580.9742,662.3203,28.69594,232,19
167,-629.4329,-214.4213,664.9528,108.8118,358,15
168,-215.3315,-637.4564,672.8434,161.3351,484,8
169,591.6763,325.854,675.4714,61.15709,316,32
170,-658.9474,160.0167,678.0981,76.35069,295,13
171,102.5831,675.6052,683.3489,8.633789,127,7
172,-534.049,-430.5233,685.9728,128.874,190,16
173,687.2234,-43.45591,688.5959,93.61823,274,29
174,16.91954,-693.6328,693.8391,178.6026,442,22
175,457.7887,524.8671,696.4596,41.09491,106,30
176,-694.7051,-78.08162,699.0793,96.41286,64,14
177,-139.5556,690.3521,704.3165,11.42841,127,5
178,-364.7727,-605.555,706.9342,148.9362,85,17
179,680.5284,200.8578,709.5511,73.55605,127,33
180,257.4751,669.6021,717.3983,21.03272,400,18
181,-644.5043,-320.9875,720.0131,116.475,379,15
182,694.574,-199.3914,722.6272,106.0172,85,35
183,-138.9016,-714.4776,727.8543,168.9984,64,21
184,587.1448,434.5615,730.4674,53.49387,484,31
185,-729.0827,76.45076,733.08,84.01391,316,13
186,12.50571,738.1982,738.3041,0.9707584,379,6
187,-509.6636,-537.7726,740.9159,136.5372,211,16
188,741.6751,52.44835,743.5273,85.955,400,34
189,117.9116,-739.4072,748.7498,170.9395,232,23
190,413.9564,627.043,751.3607,33.43168,253,19
191,-731.3324,-183.3735,753.9714,104.0761,85,14
192,-248.3167,717.4345,759.1926,19.09164,421,4
193,-302.5558,-699.1451,761.8031,156.5994,1,8
194,697.7438,312.2208,764.4136,65.89282,337,32
195,-727.874,241.9205,767.0242,71.61495,106,12
196,178.5663,751.3165,772.245,13.36952,148,7
197,-641.337,-434.8428,774.8558,124.1383,400,15
198,769.2172,-112.9566,777.4666,98.35396,295,29
199,-45.55469,-781.3615,782.6882,176.6633,463,22
200,563.2654,547.1993,785.2994,45.82889,127,30
201,-787.5724,-23.08405,787.9106,91.67889,337,13
202,-92.45891,787.7264,793.1339,6.694451,148,5
203,-465.4529,-645.4186,795.7459,144.2022,106,17
204,781.7424,162.033,798.3582,78.29002,148,33
205,231.261,-769.5878,803.5839,163.2745,421,24
206,350.4602,726.0381,806.197,25.76671,421,18
207,-751.2777,-299.5937,808.8106,111.7411,106,14
208,758.786,-287.496,811.4247,110.7512,106,35
209,-221.4757,-786.0486,816.654,164.2644,85,21
210,696.5006,431.3802,819.2692,58.22784,1,31
211,-807.5412,152.8796,821.8849,79.27992,127,12
212,82.21424,823.0219,827.118,5.704545,400,6
213,-618.5167,-553.0806,829.7355,131.8032,232,16
214,832.2925,-10.05965,832.3533,90.69248,421,34
215,63.13769,-835.2076,837.5907,175.6769,253,23
216,519.2377,660.5646,840.2104,38.16917,274,19
217,-831.6602,-136.7651,842.8305,99.33862,358,13
218,-210.2499,821.5978,848.0731,14.35416,442,4
219,-401.1862,-750.1548,850.6953,151.8619,22,8
220,805.019,283.0135,853.3184,70.63029,358,32
221,-787.1817,336.1274,855.942,66.87747,442,11
222,354.4763,-781.9738,858.5665,155.6148,85,25
223,267.6516,818.5434,861.1915,18.10698,169,7
224,-752.5639,-424.0616,863.8175,119.4008,421,15
225,843.925,-196.2546,866.4441,103.0914,316,29
226,-122.4605,-863.0552,871.7001,171.9241,484,22
227,675.3147,555.3393,874.3293,50.56812,148,30
228,-875.7086,46.81887,876.9593,86.93965,148,12
229,-30.09966,881.7083,882.2219,1.955247,169,5
230,-575.102,-672.4772,884.8547,139.463,127,17
231,880.9282,107.7078,887.4883,83.02926,169,33
232,185.406,-873.2939,892.7585,168.0137,442,24
233,454.5273,771.4514,895.395,30.50593,442,18
234,-858.7843,-262.5867,898.0325,107.0018,127,14
235,812.9974,-387.6126,900.671,115.4904,127,35
236,-338.6402,837.4325,903.3108,22.01738,274,3
237,-316.8983,-848.7184,905.9512,159.5251,106,21
238,809.3251,412.9576,908.5928,62.96708,22,31
239,-878.267,242.8933,911.2354,74.5407,463,11
240,484.9377,-774.6036,913.8792,147.9515,232,26
241,166.1386,901.3401,916.5239,10.44376,421,6
242,-733.4631,-553.9901,919.1698,127.064,253,16
243,917.6832,-87.20253,921.8171,95.42822,442,34
244,-6.677413,-927.0906,927.1146,179.5874,274,23
245,632.9687,681.0387,929.765,42.90489,295,19
246,-929.4098,-74.8255,932.4169,94.60287,379,13
247,-156.6803,924.5417,937.7239,9.618423,463,4
248,-510.429,-789.7946,940.3793,147.1262,43,8
249,912.4434,238.2514,943.0358,75.36604,379,32
250,-836.0938,441.9092,945.6937,62.14175,316,10
251,318.8984,-893.1275,948.3527,160.3505,106,25
252,369.186,876.429,951.0131,22.84272,190,7
253,-866.6643,-397.9808,953.6749,114.6651,442,15
254,910.4186,-292.7798,956.3378,107.8272,337,29
255,-474.8639,833.1803,959.0021,29.6806,148,2
256,-213.2463,-937.7266,961.6678,167.1884,1,22
257,792.859,548.9228,964.3348,55.30385,169,30
258,-958.0653,131.1718,967.0032,82.20393,169,12
259,619.5481,-745.9394,969.6729,140.2883,421,27
260,47.16883,971.1993,972.3441,2.780589,190,5
261,-692.7153,-686.1508,975.0166,134.7272,148,17
262,976.9468,38.12837,977.6907,87.76499,190,33
263,-748.1672,633.532,980.3658,49.74279,190,9
264,124.0684,-975.1821,983.0428,172.7495,463,24
265,568.787,805.0632,985.7208,35.24167,463,18
266,-965.8367,-209.9879,988.4004,102.2661,148,14
267,856.3395,-498.9244,991.0817,120.2261,148,35
268,-295.2166,948.9017,993.7643,17.28165,295,3
269,-424.4336,-901.535,996.4484,154.7894,127,21
270,924.4272,379.0823,999.1342,67.70281,43,31
271,-940.2322,345.8456,1001.821,69.80496,484,11
272,460.9165,-892.5225,1004.51,152.6873,253,26
273,263.7291,972.0594,1007.2,15.17949,442,6
274,-853.3567,-540.0595,1009.892,122.3283,274,16
275,996.6947,-178.6862,1012.585,100.1639,463,34
276,-615.8658,807.1578,1015.28,37.34383,22,1
277,-91.34881,-1013.87,1017.977,174.8516,295,23
278,754.2108,687.7089,1020.675,47.64063,316,19
279,754.9876,-694.8567,1026.076,132.6251,106,28
280,-87.56545,1025.046,1028.779,4.882667,484,4
281,-629.491,-817.1292,1031.484,142.3905,64,8
282,1018.796,177.776,1034.19,80.10177,400,32
283,-873.5959,558.559,1036.898,57.406,337,10
284,267.5589,-1004.588,1039.608,165.0862,127,25
285,482.5549,923.8887,1042.319,27.57845,211,7
286,-982.4495,-356.2106,1045.033,109.9293,463,15
287,967.5513,-402.0179,1047.747,112.5629,358,29
288,-443.0289,952.4702,1050.464,24.94488,169,2
289,-317.528,-1004.175,1053.182,162.4527,22,22
290,914.8025,527.319,1055.902,60.03959,190,30
291,-1033.403,229.7019,1058.624,77.46819,190,12
292,608.399,-869.6602,1061.347,145.024,442,27
293,139.1888,1054.93,1064.073,7.516246,211,5
294,-817.3177,-685.6046,1066.8,129.9915,169,17
295,-758.2952,758.1085,1072.259,45.00705,211,9
296,692.4232,825.8591,1077.726,39.9774,484,18
297,-1071.144,-141.5964,1080.462,97.53037,169,14
298,887.7192,-620.7075,1083.2,124.9619,169,35
299,-235.89,1060.01,1085.94,12.54591,316,3
300,-543.4573,-943.336,1088.682,150.0537,148,21
301,1040.558,329.3144,1091.426,72.43855,64,31
302,-992.2141,461.2181,1094.171,65.06924,1,11
303,421.1343,-1012.856,1096.919,157.423,274,26
304,374.5792,1033.906,1099.668,19.91521,463,6
305,-977.0345,-510.6195,1102.42,117.5926,295,16
306,1068.014,-284.1702,1105.173,104.8997,484,34
307,-597.0511,933.2922,1107.928,32.60809,43,1
308,-190.656,-1094.199,1110.685,170.1159,316,23
309,881.8898,679.7264,1113.444,52.37636,337,19
310,-1112.178,94.73304,1116.205,85.13142,421,13
311,757.9659,-823.1509,1118.968,137.3608,127,28
312,-757.4596,-831.1171,1124.5,137.6547,85,8
313,1122.696,101.4326,1127.269,84.83749,421,32
314,-898.5618,685.2574,1130.04,52.67029,358,10
315,200.1768,-1114.986,1132.813,169.8219,148,25
316,607.0419,959.7191,1135.588,32.3142,232,7
317,-1098.574,-298.3443,1138.365,105.1936,484,15
318,1014.053,-523.3612,1141.145,117.2986,379,29
319,-395.1667,1073.503,1143.925,20.20914,190,2
320,-434.8126,-1061.074,1146.709,157.7169,43,22
321,1039.883,489.8791,1149.495,64.77531,211,30
322,-1100.347,342.0364,1152.282,72.73245,211,12
323,581.7249,-997.891,1155.072,149.7598,463,27
324,245.7121,1131.491,1157.863,12.252,232,5
325,-947.7732,-669.963,1160.657,125.2558,190,17
326,1154.186,-146.5537,1163.453,97.23645,232,33
327,-753.8738,889.84,1166.251,40.27132,232,9
328,-45.30357,-1168.173,1169.051,177.7791,1,24
329,824.4665,832.7639,1171.854,44.71313,1,18
330,-1173.261,-57.27198,1174.658,92.79464,190,14
331,905.9725,-752.0886,1177.465,129.6976,190,35
332,-160.3893,1169.325,1180.274,7.810173,337,3
333,-673.2009,-972.877,1183.085,145.318,169,21
334,1156.31,263.2531,1185.898,77.17428,85,31
335,-1032.898,588.3546,1188.713,60.33349,22,11
336,365.0625,-1134.229,1191.531,162.1587,295,26
337,498.1508,1085.504,1194.351,24.65095,484,6
338,-1103.169,-465.0174,1197.173,112.8568,316,16
339,1130.217,-403.2394,1199.997,109.6354,1,34
340,-562.3243,1063.286,1202.824,27.87236,64,1
341,-304.3126,-1166.616,1205.653,165.3801,337,23
342,1014.806,656.2034,1208.484,57.11209,358,19
343,-1194.339,202.0998,1211.317,80.39568,442,13
344,745.8937,-958.0236,1214.153,142.0966,148,28
345,97.36363,1213.09,1216.991,4.588768,22,4
346,-893.3032,-830.6606,1219.831,132.919,106,8
347,1222.64,9.107096,1222.674,89.57323,442,32
348,-909.8003,821.0718,1225.518,47.93454,379,10
349,116.5026,-1222.828,1228.366,174.5577,169,25
350,741.8202,982.6464,1231.215,37.04992,253,7
351,-1213.568,-223.9984,1234.067,100.4579,1,15
352,1048.575,-656.0974,1236.921,122.0344,400,29
353,-330.7616,1194.841,1239.778,15.4734,211,2
354,-564.5089,-1107.012,1242.636,152.9812,64,22
355,1166.707,435.9576,1245.498,69.51105,232,30
356,-1157.434,467.7107,1248.362,67.99673,232,12
357,538.7559,-1129.297,1251.228,154.4955,484,27
358,366.4053,1199.377,1254.096,16.98772,253,5
359,-1082.816,-638.3377,1256.967,120.52,211,17
360,1232.437,-261.3372,1259.84,101.9722,253,33
361,-733.9009,1027.541,1262.716,35.53558,253,9
362,-153.2864,-1256.277,1265.594,173.0434,22,24
363,963.8199,824.6686,1268.474,49.44887,22,18
364,-1270.628,43.06342,1271.357,88.05891,211,14
365,909.893,-892.0701,1274.243,134.4333,211,35
366,-68.49705,1275.292,1277.131,3.074535,358,3
367,-812.7751,-988.863,1280.021,140.5822,190,21
368,1270.146,180.5423,1282.914,81.91,106,31
369,-1060.91,726.4808,1285.809,55.59777,43,11
370,292.2085,-1255.141,1288.707,166.8945,316,26
371,633.7932,1125.413,1291.607,29.38668,1,6
372,-1230.304,-402.6265,1294.51,108.1211,337,16
373,1181.805,-535.3726,1297.415,114.3711,22,34
374,-510.9294,1195.739,1300.323,23.13663,85,1
375,-431.9306,-1229.574,1303.233,160.6444,358,23
376,1151.626,616.2593,1306.146,61.84783,379,19
377,-1268.275,324.2234,1309.061,75.65995,463,13
378,717.7729,-1098.222,1311.979,146.8323,169,28
379,213.0478,1297.526,1314.9,9.324513,43,4
380,-1035.858,-814.6501,1317.823,128.1833,127,8
381,1317.015,-99.23397,1320.748,94.30896,463,32
382,-906.099,964.9376,1323.677,43.19881,400,10
383,16.35963,-1326.506,1326.607,179.2934,190,25
384,885.9338,991.3628,1329.541,41.78564,274,7
385,-1325.837,-132.8533,1332.477,95.72213,22,15
386,1069.726,-799.387,1335.415,126.7701,421,29
387,-249.3528,1314.922,1338.356,10.73768,232,2
388,-705.9014,-1140.522,1341.3,148.2455,85,22
389,1293.757,364.9557,1344.247,74.24678,253,30
390,-1203.134,606.14,1347.196,63.26099,253,12
391,478.7585,-1262.414,1350.147,159.2312,1,27
392,500.8197,1257.006,1353.102,21.72346,274,5
393,-1221.047,-589.8647,1356.059,115.7843,232,17
394,1301.645,-390.7081,1359.019,106.7079,274,33
395,-697.3897,1169.889,1361.981,30.79985,274,9
396,-276.6156,-1336.623,1364.946,168.3076,43,24
397,1109.25,800.4698,1367.914,54.18459,43,18
398,-1361.596,159.3082,1370.884,83.32667,232,14
399,898.2681,-1039.518,1373.857,139.1691,232,35
400,39.83141,1376.256,1376.833,1.657766,379,3
401,-961.1535,-989.9818,1379.812,135.8465,211,21
402,1380.419,80.99081,1382.792,86.64224,127,31
403,-1074.848,874.6884,1385.777,50.86203,64,11
404,202.2347,-1373.96,1388.764,171.6267,337,26
405,780.7217,1152.15,1391.753,34.12241,22,6
406,-1356.837,-322.9652,1394.745,103.3888,358,16
407,1221.225,-679.9168,1397.74,119.1069,43,34
408,-442.2435,1329.092,1400.738,18.40441,106,1
409,-572.9952,-1281.467,1403.738,155.9087,379,23
410,1290.849,559.1339,1406.742,66.58006,400,19
411,-1332.334,460.7315,1409.748,70.92422,484,13
412,672.7109,-1242.313,1412.757,151.5645,190,28
413,343.9493,1373.353,1415.769,14.06022,64,4
414,-1183.772,-782.0671,1418.783,123.451,148,8
415,1404.121,-223.5138,1421.8,99.04469,484,32
416,1068.511,-46.66564,1069.529,92.50072,211,33
417,-1023.373,2.372955,1023.375,89.86715,400,13
418,47.16838,-1073.957,1074.992,177.4852,484,24
419,-2.877143,1121.73,1121.733,0.1467098,1,4`;
  return baseData;
}

function loadPathData()
{
  var pathData = `PathId,Host,Universe,ChannelStart,Fixture0,Fixture1,DistanceFt
1,192.168.0.220,1,253,21,276,11.2478
1,192.168.0.220,1,253,276,307,10.62748
1,192.168.0.220,1,253,307,340,11.21266
1,192.168.0.220,1,253,340,374,11.83952
1,192.168.0.220,1,253,374,408,12.50028
2,192.168.0.220,2,1,20,255,10.56262
2,192.168.0.220,2,1,255,288,10.28871
2,192.168.0.220,2,1,288,319,10.84606
2,192.168.0.220,2,1,319,353,11.44762
2,192.168.0.220,2,1,353,387,12.08961
3,192.168.0.220,3,1,19,236,12.69464
3,192.168.0.220,3,1,236,268,9.96904
3,192.168.0.220,3,1,268,299,10.49628
3,192.168.0.220,3,1,299,332,11.0711
3,192.168.0.220,3,1,332,366,11.68844
3,192.168.0.220,3,1,366,400,12.3403
4,192.168.0.220,4,1,18,192,7.983194
4,192.168.0.220,4,1,192,218,9.241755
4,192.168.0.220,4,1,218,247,9.670653
4,192.168.0.220,4,1,247,280,10.16458
4,192.168.0.220,4,1,280,419,10.7108
4,192.168.0.220,4,1,419,345,11.30229
4,192.168.0.220,4,1,345,379,11.93505
4,192.168.0.220,4,1,379,413,12.60649
5,192.168.0.221,-1,1,17,153,8.573935
5,192.168.0.221,-1,1,153,177,8.736724
5,192.168.0.221,-1,1,177,202,9.013807
5,192.168.0.221,-1,1,202,229,9.399042
5,192.168.0.221,-1,1,229,260,9.85274
5,192.168.0.221,-1,1,260,293,10.3677
5,192.168.0.221,-1,1,293,324,10.93187
5,192.168.0.221,-1,1,324,358,11.53955
5,192.168.0.221,-1,1,358,392,12.18729
6,192.168.0.221,-1,1,16,115,13.34925
6,192.168.0.221,-1,1,115,139,8.670046
6,192.168.0.221,-1,1,139,162,8.638669
6,192.168.0.221,-1,1,162,186,8.828212
6,192.168.0.221,-1,1,186,212,9.149339
6,192.168.0.221,-1,1,212,241,9.565928
6,192.168.0.221,-1,1,241,273,10.04334
6,192.168.0.221,-1,1,273,304,10.57797
6,192.168.0.221,-1,1,304,337,11.1593
6,192.168.0.221,-1,1,337,371,11.78261
6,192.168.0.221,-1,1,371,405,12.4451
7,192.168.0.221,-1,1,15,99,16.65833
7,192.168.0.221,-1,1,99,124,8.882273
7,192.168.0.221,-1,1,124,147,8.623285
7,192.168.0.221,-1,1,147,171,8.691382
7,192.168.0.221,-1,1,171,196,8.938684
7,192.168.0.221,-1,1,196,223,9.300398
7,192.168.0.221,-1,1,223,252,9.73964
7,192.168.0.221,-1,1,252,285,10.24183
7,192.168.0.221,-1,1,285,316,10.79505
7,192.168.0.221,-1,1,316,350,11.39286
7,192.168.0.221,-1,1,350,384,12.0314
8,192.168.0.220,-1,1,31,70,13.80582
8,192.168.0.220,-1,1,70,57,6.485778
8,192.168.0.220,-1,1,57,73,16.49349
8,192.168.0.220,-1,1,73,94,7.050253
8,192.168.0.220,-1,1,94,110,7.040404
8,192.168.0.220,-1,1,110,125,7.277885
8,192.168.0.220,-1,1,125,140,7.636117
8,192.168.0.220,-1,1,140,154,8.066376
8,192.168.0.220,-1,1,154,168,8.539245
8,192.168.0.220,-1,1,168,193,8.902852
8,192.168.0.220,-1,1,193,219,9.253351
8,192.168.0.220,-1,1,219,248,9.684339
8,192.168.0.220,-1,1,248,281,10.17994
8,192.168.0.220,-1,1,281,312,10.72755
8,192.168.0.220,-1,1,312,346,11.32035
8,192.168.0.220,-1,1,346,380,11.95424
8,192.168.0.220,-1,1,380,414,12.62163
9,192.168.0.222,-1,1,22,263,11.92004
9,192.168.0.222,-1,1,263,295,10.41561
9,192.168.0.222,-1,1,295,327,10.9838
9,192.168.0.222,-1,1,327,361,11.59512
9,192.168.0.222,-1,1,361,395,12.2463
10,192.168.0.222,-1,1,23,250,20.10643
10,192.168.0.222,-1,1,250,283,10.21081
10,192.168.0.222,-1,1,283,314,10.76121
10,192.168.0.222,-1,1,314,348,11.35653
10,192.168.0.222,-1,1,348,382,11.99277
11,192.168.0.222,-1,1,24,221,18.7122
11,192.168.0.222,-1,1,221,239,10.86185
11,192.168.0.222,-1,1,239,271,10.01347
11,192.168.0.222,-1,1,271,302,10.54518
11,192.168.0.222,-1,1,302,335,11.12391
11,192.168.0.222,-1,1,335,369,11.74484
11,192.168.0.222,-1,1,369,403,12.4051
12,192.168.0.222,-1,1,25,195,18.81389
12,192.168.0.222,-1,1,195,211,9.956536
12,192.168.0.222,-1,1,211,228,10.50649
12,192.168.0.222,-1,1,228,258,9.824153
12,192.168.0.222,-1,1,258,291,10.33598
12,192.168.0.222,-1,1,291,322,10.89742
12,192.168.0.222,-1,1,322,356,11.50268
12,192.168.0.222,-1,1,356,390,12.14812
13,192.168.0.222,-1,1,26,170,19.60672
13,192.168.0.222,-1,1,170,185,9.09143
13,192.168.0.222,-1,1,185,201,9.620645
13,192.168.0.222,-1,1,201,217,10.16088
13,192.168.0.222,-1,1,217,246,9.643456
13,192.168.0.222,-1,1,246,417,10.13402
13,192.168.0.222,-1,1,417,310,10.67731
13,192.168.0.222,-1,1,310,343,11.26634
13,192.168.0.222,-1,1,343,377,11.89673
13,192.168.0.222,-1,1,377,411,12.56595
14,192.168.0.223,-1,1,27,146,20.65046
14,192.168.0.223,-1,1,146,161,8.287125
14,192.168.0.223,-1,1,161,176,8.775577
14,192.168.0.223,-1,1,176,191,9.290045
14,192.168.0.223,-1,1,191,207,9.826586
14,192.168.0.223,-1,1,207,234,9.474792
14,192.168.0.223,-1,1,234,266,9.939684
14,192.168.0.223,-1,1,266,297,10.46387
14,192.168.0.223,-1,1,297,330,11.03607
14,192.168.0.223,-1,1,330,364,11.65101
14,192.168.0.223,-1,1,364,398,12.30064
15,192.168.0.223,-1,1,28,132,13.03643
15,192.168.0.223,-1,1,132,123,9.704843
15,192.168.0.223,-1,1,123,138,7.580168
15,192.168.0.223,-1,1,138,152,8.001962
15,192.168.0.223,-1,1,152,167,8.469617
15,192.168.0.223,-1,1,167,181,8.968878
15,192.168.0.223,-1,1,181,197,9.491597
15,192.168.0.223,-1,1,197,224,9.31233
15,192.168.0.223,-1,1,224,253,9.753584
15,192.168.0.223,-1,1,253,286,10.25742
15,192.168.0.223,-1,1,286,317,10.812
15,192.168.0.223,-1,1,317,351,11.41107
15,192.168.0.223,-1,1,351,385,12.05077
16,192.168.0.223,-1,1,29,108,15.79121
16,192.168.0.223,-1,1,108,98,8.140475
16,192.168.0.223,-1,1,98,114,7.081012
16,192.168.0.223,-1,1,114,129,7.3551
16,192.168.0.223,-1,1,129,143,7.733225
16,192.168.0.223,-1,1,143,157,8.17565
16,192.168.0.223,-1,1,157,172,8.656636
16,192.168.0.223,-1,1,172,187,9.16554
16,192.168.0.223,-1,1,187,213,9.160332
16,192.168.0.223,-1,1,213,242,9.579161
16,192.168.0.223,-1,1,242,274,10.05833
16,192.168.0.223,-1,1,274,305,10.59444
16,192.168.0.223,-1,1,305,338,11.17704
16,192.168.0.223,-1,1,338,372,11.80157
16,192.168.0.223,-1,1,372,406,12.46008
17,192.168.0.223,-1,1,30,91,13.17797
17,192.168.0.223,-1,1,91,78,7.215507
17,192.168.0.223,-1,1,78,65,6.716526
17,192.168.0.223,-1,1,65,86,7.178123
17,192.168.0.223,-1,1,86,104,7.003928
17,192.168.0.223,-1,1,104,119,7.168284
17,192.168.0.223,-1,1,119,134,7.489415
17,192.168.0.223,-1,1,134,148,7.896676
17,192.168.0.223,-1,1,148,163,8.355
17,192.168.0.223,-1,1,163,178,8.84765
17,192.168.0.223,-1,1,178,203,9.02373
17,192.168.0.223,-1,1,203,230,9.411517
17,192.168.0.223,-1,1,230,261,9.867107
17,192.168.0.223,-1,1,261,294,10.38362
17,192.168.0.223,-1,1,294,325,10.94914
17,192.168.0.223,-1,1,325,359,11.55804
17,192.168.0.223,-1,1,359,393,12.20691
18,192.168.0.223,-1,1,34,88,11.47775
18,192.168.0.223,-1,1,88,80,10.26072
18,192.168.0.223,-1,1,80,93,7.299556
18,192.168.0.223,-1,1,93,109,7.03378
18,192.168.0.223,-1,1,109,133,8.727777
18,192.168.0.223,-1,1,133,156,8.621276
18,192.168.0.223,-1,1,156,180,8.769455
18,192.168.0.223,-1,1,180,206,9.064293
18,192.168.0.223,-1,1,206,233,9.462012
18,192.168.0.223,-1,1,233,265,9.92507
18,192.168.0.223,-1,1,265,296,10.44773
18,192.168.0.223,-1,1,296,329,11.01862
18,192.168.0.223,-1,1,329,363,11.63235
18,192.168.0.223,-1,1,363,397,12.28579
19,192.168.0.224,-1,1,33,75,10.5191
19,192.168.0.224,-1,1,75,67,9.01972
19,192.168.0.224,-1,1,67,59,8.222008
19,192.168.0.224,-1,1,59,72,6.534785
19,192.168.0.224,-1,1,72,103,9.679662
19,192.168.0.224,-1,1,103,118,7.156066
19,192.168.0.224,-1,1,118,142,8.645742
19,192.168.0.224,-1,1,142,166,8.655611
19,192.168.0.224,-1,1,166,190,8.868622
19,192.168.0.224,-1,1,190,216,9.207425
19,192.168.0.224,-1,1,216,245,9.629912
19,192.168.0.224,-1,1,245,278,10.11877
19,192.168.0.224,-1,1,278,309,10.66069
19,192.168.0.224,-1,1,309,342,11.24841
19,192.168.0.224,-1,1,342,376,11.87763
19,192.168.0.224,-1,1,376,410,12.54061
20,192.168.0.225,-1,1,32,83,6.896864
20,192.168.0.225,-1,1,83,62,7.254766
20,192.168.0.225,-1,1,62,5,8.133898
20,192.168.0.225,-1,1,5,4,6.23736
20,192.168.0.225,-1,1,4,3,6.23736
20,192.168.0.225,-1,1,3,2,6.23736
20,192.168.0.225,-1,1,2,1,6.23736
20,192.168.0.225,-1,1,1,0,6.23736
20,192.168.0.225,-1,1,0,14,6.237359
20,192.168.0.225,-1,1,14,13,6.237358
20,192.168.0.225,-1,1,13,12,6.237361
20,192.168.0.225,-1,1,12,11,6.23736
20,192.168.0.225,-1,1,11,10,6.237359
20,192.168.0.225,-1,1,10,9,6.237361
20,192.168.0.225,-1,1,9,8,6.23736
20,192.168.0.225,-1,1,8,7,6.23736
20,192.168.0.225,-1,1,7,6,6.237358
21,192.168.0.225,-1,1,44,79,12.07954
21,192.168.0.225,-1,1,79,58,7.388508
21,192.168.0.225,-1,1,58,71,6.509409
21,192.168.0.225,-1,1,71,63,8.6239
21,192.168.0.225,-1,1,63,55,7.815306
21,192.168.0.225,-1,1,55,60,11.57715
21,192.168.0.225,-1,1,60,81,7.316652
21,192.168.0.225,-1,1,81,100,7.003195
21,192.168.0.225,-1,1,100,116,7.110807
21,192.168.0.225,-1,1,116,130,7.40333
21,192.168.0.225,-1,1,130,144,7.79426
21,192.168.0.225,-1,1,144,159,8.242277
21,192.168.0.225,-1,1,159,183,8.797892
21,192.168.0.225,-1,1,183,209,9.106181
21,192.168.0.225,-1,1,209,237,9.513493
21,192.168.0.225,-1,1,237,269,9.983804
21,192.168.0.225,-1,1,269,300,10.51254
21,192.168.0.225,-1,1,300,333,11.08867
21,192.168.0.225,-1,1,333,367,11.70721
21,192.168.0.225,-1,1,367,401,12.3652
22,192.168.0.225,-1,1,45,92,12.33661
22,192.168.0.225,-1,1,92,84,10.62918
22,192.168.0.225,-1,1,84,76,9.886447
22,192.168.0.225,-1,1,76,68,9.117656
22,192.168.0.225,-1,1,68,89,7.118558
22,192.168.0.225,-1,1,89,106,7.01297
22,192.168.0.225,-1,1,106,121,7.206943
22,192.168.0.225,-1,1,121,136,7.543345
22,192.168.0.225,-1,1,136,150,7.959525
22,192.168.0.225,-1,1,150,174,8.712915
22,192.168.0.225,-1,1,174,199,8.975013
22,192.168.0.225,-1,1,199,226,9.349812
22,192.168.0.225,-1,1,226,256,9.795774
22,192.168.0.225,-1,1,256,289,10.30442
22,192.168.0.225,-1,1,289,320,10.86314
22,192.168.0.225,-1,1,320,354,11.46593
22,192.168.0.225,-1,1,354,388,12.10907
23,192.168.0.225,-1,1,46,102,16.00114
23,192.168.0.225,-1,1,102,96,11.79111
23,192.168.0.225,-1,1,96,112,7.063331
23,192.168.0.225,-1,1,112,127,7.32347
23,192.168.0.225,-1,1,127,165,12.60645
23,192.168.0.225,-1,1,165,189,8.860333
23,192.168.0.225,-1,1,189,215,9.196115
23,192.168.0.225,-1,1,215,244,9.616461
23,192.168.0.225,-1,1,244,277,10.10358
23,192.168.0.225,-1,1,277,308,10.64406
23,192.168.0.225,-1,1,308,341,11.23052
23,192.168.0.225,-1,1,341,375,11.85855
23,192.168.0.225,-1,1,375,409,12.52554
24,192.168.0.225,-1,1,47,205,13.91713
24,192.168.0.225,-1,1,205,232,9.449285
24,192.168.0.225,-1,1,232,264,9.91052
24,192.168.0.225,-1,1,264,418,10.43167
24,192.168.0.225,-1,1,418,328,11.00116
24,192.168.0.225,-1,1,328,362,11.61372
24,192.168.0.225,-1,1,362,396,12.26603
25,192.168.0.225,-1,1,48,222,10.37555
25,192.168.0.225,-1,1,222,251,9.725718
25,192.168.0.225,-1,1,251,284,10.22631
25,192.168.0.225,-1,1,284,315,10.77808
25,192.168.0.225,-1,1,315,349,11.3747
25,192.168.0.225,-1,1,349,383,12.01204
26,192.168.0.225,-1,1,49,240,10.16696
26,192.168.0.225,-1,1,240,272,10.02838
26,192.168.0.225,-1,1,272,303,10.56156
26,192.168.0.225,-1,1,303,336,11.14158
26,192.168.0.225,-1,1,336,370,11.7637
26,192.168.0.225,-1,1,370,404,12.42004
27,192.168.0.225,-1,1,50,51,6.257389
27,192.168.0.225,-1,1,51,52,6.257396
27,192.168.0.225,-1,1,52,259,7.157995
27,192.168.0.225,-1,1,259,292,10.35182
27,192.168.0.225,-1,1,292,323,10.91463
27,192.168.0.225,-1,1,323,357,11.52109
27,192.168.0.225,-1,1,357,391,12.16768
28,192.168.0.225,-1,1,36,35,6.257388
28,192.168.0.225,-1,1,35,54,6.257358
28,192.168.0.225,-1,1,54,53,6.257399
28,192.168.0.225,-1,1,53,279,10.68695
28,192.168.0.225,-1,1,279,311,10.69404
28,192.168.0.225,-1,1,311,344,11.28432
28,192.168.0.225,-1,1,344,378,11.91586
28,192.168.0.225,-1,1,378,412,12.58108
29,192.168.0.225,-1,1,38,158,12.43604
29,192.168.0.225,-1,1,158,149,11.45118
29,192.168.0.225,-1,1,149,173,8.70187
29,192.168.0.225,-1,1,173,198,8.957187
29,192.168.0.225,-1,1,198,225,9.324328
29,192.168.0.225,-1,1,225,254,9.767598
29,192.168.0.225,-1,1,254,287,10.27303
29,192.168.0.225,-1,1,287,318,10.82903
29,192.168.0.225,-1,1,318,352,11.42931
29,192.168.0.225,-1,1,352,386,12.07018
30,192.168.0.225,-1,1,43,66,13.63132
30,192.168.0.225,-1,1,66,61,12.70381
30,192.168.0.225,-1,1,61,56,11.77013
30,192.168.0.225,-1,1,56,64,7.917247
30,192.168.0.225,-1,1,64,85,7.201778
30,192.168.0.225,-1,1,85,128,13.90857
30,192.168.0.225,-1,1,128,151,8.617977
30,192.168.0.225,-1,1,151,175,8.718674
30,192.168.0.225,-1,1,175,200,8.984572
30,192.168.0.225,-1,1,200,227,9.362027
30,192.168.0.225,-1,1,227,257,9.809933
30,192.168.0.225,-1,1,257,290,10.32018
30,192.168.0.225,-1,1,290,321,10.88028
30,192.168.0.225,-1,1,321,355,11.48427
30,192.168.0.225,-1,1,355,389,12.1286
31,192.168.0.225,-1,1,42,87,8.230258
31,192.168.0.225,-1,1,87,74,7.051933
31,192.168.0.225,-1,1,74,82,9.696746
31,192.168.0.225,-1,1,82,69,6.858373
31,192.168.0.225,-1,1,69,77,9.215171
31,192.168.0.225,-1,1,77,97,7.018486
31,192.168.0.225,-1,1,97,113,7.071939
31,192.168.0.225,-1,1,113,137,8.688811
31,192.168.0.225,-1,1,137,160,8.630687
31,192.168.0.225,-1,1,160,184,8.805305
31,192.168.0.225,-1,1,184,210,9.116839
31,192.168.0.225,-1,1,210,238,9.52653
31,192.168.0.225,-1,1,238,270,9.998609
31,192.168.0.225,-1,1,270,301,10.52882
31,192.168.0.225,-1,1,301,334,11.1063
31,192.168.0.225,-1,1,334,368,11.72599
31,192.168.0.225,-1,1,368,402,12.38009
32,192.168.0.230,1,1,41,105,6.782984
32,192.168.0.230,1,1,105,95,7.959249
32,192.168.0.230,1,1,95,101,11.61575
32,192.168.0.230,1,1,101,90,7.735031
32,192.168.0.230,1,1,90,107,7.017276
32,192.168.0.230,1,1,107,122,7.220467
32,192.168.0.230,1,1,122,145,8.629345
32,192.168.0.230,1,1,145,169,8.676785
32,192.168.0.230,1,1,169,194,8.911671
32,192.168.0.230,1,1,194,220,9.264997
32,192.168.0.230,1,1,220,249,9.698081
32,192.168.0.230,1,1,249,282,10.19536
32,192.168.0.230,1,1,282,313,10.74436
32,192.168.0.230,1,1,313,347,11.33843
32,192.168.0.230,1,1,347,381,11.97347
32,192.168.0.230,1,1,381,415,12.64716
33,192.168.0.230,2,1,40,120,9.010204
33,192.168.0.230,2,1,120,111,8.920111
33,192.168.0.230,2,1,111,117,13.40791
33,192.168.0.230,2,1,117,131,7.420139
33,192.168.0.230,2,1,131,155,8.618126
33,192.168.0.230,2,1,155,179,8.749434
33,192.168.0.230,2,1,179,204,9.033734
33,192.168.0.230,2,1,204,231,9.424041
33,192.168.0.230,2,1,231,262,9.881532
33,192.168.0.230,2,1,262,416,10.39963
33,192.168.0.230,2,1,416,326,10.96643
33,192.168.0.230,2,1,326,360,11.57654
33,192.168.0.230,2,1,360,394,12.2266
34,192.168.0.230,3,1,39,135,14.72452
34,192.168.0.230,3,1,135,126,9.889891
34,192.168.0.230,3,1,126,141,7.655245
34,192.168.0.230,3,1,141,164,8.644928
34,192.168.0.230,3,1,164,188,8.844044
34,192.168.0.230,3,1,188,214,9.17375
34,192.168.0.230,3,1,214,243,9.589692
34,192.168.0.230,3,1,243,275,10.07336
34,192.168.0.230,3,1,275,306,10.61094
34,192.168.0.230,3,1,306,339,11.19483
34,192.168.0.230,3,1,339,373,11.82052
34,192.168.0.230,3,1,373,407,12.48526
35,192.168.0.230,4,253,37,182,10.88806
35,192.168.0.230,4,253,182,208,9.085075
35,192.168.0.230,4,253,208,235,9.487635
35,192.168.0.230,4,253,235,267,9.95434
35,192.168.0.230,4,253,267,298,10.48006
35,192.168.0.230,4,253,298,331,11.05357
35,192.168.0.230,4,253,331,365,11.66969
35,192.168.0.230,4,253,365,399,12.32543`;
  return pathData;
}


async function importCSV() {

  const nodes: SceneNode[] = [];
  const lines: SceneNode[] = [];
  const pageNode = figma.currentPage;

  // make sure we are on the right page
  if (pageNode.name != "Assets")
  {
    console.error(`need to be on the Assets page to run`);
    return;
  }

  // import the CSV data
  buildMaps();
  
  console.log(`finding node 'Map'`);
  const mapNode = pageNode.findOne(node => node.type === "FRAME" && node.name === "Map") as FrameNode;
  //const mapNode = node.findOne(node => node.type === "GROUP" && node.name === "Map") as FrameNode;
  if (mapNode == null)
  {
    console.log(`mapNode is null !`);
    return;
  }
//  else
//  {
//    console.log(`mapNode node.type = '${mapNode.type}'`);
//    return;
//  }

  // first get rid of old lights & wiring path data
  console.log(`finding and deleting node 'Lights'`);
  const lights = pageNode.findOne(node => node.type === "GROUP" && node.name === "Lights") as FrameNode;
  if (lights != null)
  {
    lights.remove();
  }

  console.log(`finding and deleting node 'Wiring Paths'`);
  const wiringPaths = pageNode.findOne(node => node.type === "GROUP" && node.name === "Wiring Paths") as FrameNode;
  if (wiringPaths != null)
  {
    wiringPaths.remove();
  }

  // now we draw the wiring path lines
  var testLoopMax = 500;
  for (let path of pathList) {

    var cols = path.split(",");
    console.log(`path = ${path} cols.length = ${cols.length}`);

    const line = figma.createLine();
    var startNodeId = cols[4];
    var endNodeId = cols[5];

    console.log(`startNodeId = ${startNodeId} endNodeId = ${endNodeId}`);

    console.log(`(lightBaseMap.get(startNodeId) = ${lightBaseMap.get(startNodeId)} lightBaseMap.get(endNodeId) = ${lightBaseMap.get(endNodeId)}`);

    var startX = parseFloat(lightBaseMap.get(startNodeId)[1]);
    var startZ = -parseFloat(lightBaseMap.get(startNodeId)[2]);
    var endX = parseFloat(lightBaseMap.get(endNodeId)[1]);
    var endZ = -parseFloat(lightBaseMap.get(endNodeId)[2]);

    console.log(`processing path from node ${cols[4]} to ${cols[5]}`);

    var length = Math.sqrt((endX - startX)*(endX - startX) + (endZ - startZ)*(endZ - startZ));
    var rot = -Math.atan2(endZ - startZ, endX - startX) * 180 / Math.PI;

    line.resize(length,0);
    line.x = startX;
    line.y = startZ;
    line.rotation = rot;

    // add the length of the line
    var lineLength = figma.createText();
    lineLength.fontSize = 8;
    lineLength.characters = parseFloat(cols[6]).toFixed(2) + " (ft)";
    lineLength.x = ((startX + endX) / 2) + 10;
    lineLength.y = (startZ + endZ) / 2;

    // for now just put node in the main page; group later
    pageNode.appendChild(lineLength);
    lines.push(lineLength);

    // for now just put node in the main page; group later
    pageNode.appendChild(line);
    lines.push(line);

    testLoopMax -=1;
    if (testLoopMax == 0)
      break;
  }

  console.log(`done processing paths`);

  // and now we group the new lines together
  figma.currentPage.selection = lines;
  figma.viewport.scrollAndZoomIntoView(lines);
  console.log(`figma.group()`);
  const newLines = figma.group(lines,mapNode);
  newLines.name = "Wiring Paths";

  // now add new lights and group together
  console.log(`finding node 'Light Base'`);
  const base = pageNode.findOne(node => node.type === "COMPONENT" && node.name === "Light Base") as ComponentNode;
  var testLoopMax = 500;
  for (let key of lightBaseMap.keys()) {
    const light = base.createInstance();
    console.log(`processing lightbase ${key}`);
    console.log(`    ${lightBaseMap.get(key)}`);
    console.log(`    ${lightBaseMap.get(key)[1]}`);
    console.log(`    ${lightBaseMap.get(key)[2]}`);

    light.x = parseFloat(lightBaseMap.get(key)[1]);
    light.y = -parseFloat(lightBaseMap.get(key)[2]);  // need to invert y because in unity, y axis runs bottom-to-top, and in figma, it runs top-to-bottom
    const id = light.findOne(node => node.type === "TEXT" && node.name === "#ID") as TextNode;
    id.characters = key;

    const univ = light.findOne(node => node.type === "TEXT" && node.name === "#Universe") as TextNode;
    univ.characters = `U${lightBaseMap.get(key)[6]}`;

    var chanStart = parseInt(lightBaseMap.get(key)[5]);
    var chanEnd = chanStart+20;

    const range = light.findOne(node => node.type === "TEXT" && node.name === "#Range") as TextNode;
    range.characters = `${chanStart}-${chanEnd}`;

    light.name = `Light ${key}`;

    // for now just put light in the main page; group later
    pageNode.appendChild(light);
    nodes.push(light);

    testLoopMax -=1;
    if (testLoopMax == 0)
      break;
  }

  console.log(`done adding lights`);

  // and now we group the new lights together
  figma.currentPage.selection = nodes;
  figma.viewport.scrollAndZoomIntoView(nodes);
  const newLights = figma.group(nodes,mapNode);
  newLights.name = "Lights";

}


async function exportTags() 
{

  const pageNode = figma.currentPage;

  // make sure we are on the right page
  if (pageNode.name != "Landmarks")
  {
    console.error(`need to be on the Landmarks page to run`);
    return;
  }

  var tagNode = pageNode.findOne(node => node.type === "FRAME" && node.name === "Arms / direction A") as FrameNode;
  console.log(`found tagNode '${tagNode.name}'`);
  tagNode = tagNode.findOne(node => node.type === "FRAME" && node.name === "Map") as FrameNode;
  console.log(`found tagNode '${tagNode.name}'`);
  tagNode = tagNode.findOne(node => node.type === "GROUP" && node.name === "Lights") as FrameNode;
  console.log(`found tagNode '${tagNode.name}'`);

  for (let child of tagNode.children)
  {
    if (child.name.startsWith("CWArm"))
    {
      //console.log(`found child '${child.name}'`);
      // find the child lights
      var childGroup = child as FrameNode;
      var csvLightNumbers = "";
      for (let light of childGroup.children)
      {
        if (csvLightNumbers != "")
        {
          csvLightNumbers += ",";
        }
        csvLightNumbers += light.name.substring(6);
      }
      var groupNum = child.name.substring(6);
      console.log(`${child.name},${csvLightNumbers}`);
    }
  }

}

// This file holds the main code for the plugins. It has access to the *document*.
// You can access browser APIs such as the network by creating a UI which contains
// a full browser environment (see documentation).

(async() => {
  await loadFonts();

  console.log(`figma.command = ${figma.command}`)
  console.log(`figma.currentPage.name = '${figma.currentPage.name}'`);

  if (figma.command == "import")
  {    
    await importCSV();
  }
  else if (figma.command == "export")
  {
    await exportTags();
  }

  // Make sure to close the plugin when you're done. Otherwise the plugin will
  // keep running, which shows the cancel button at the bottom of the screen.
  figma.closePlugin();

})();


