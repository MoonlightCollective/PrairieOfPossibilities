async function loadFonts() {

  await figma.loadFontAsync({ family: "Inter", style: "Regular" });
  console.log("Awaiting the fonts.");
};


var lightBaseMap = new Map();

function buildMap() {

  var csvData = loadCsvData();
  console.log(`csvData() ${csvData}`);

  var rows = csvData.split("\n");
  console.log(`buildMap() found ${rows.length} rows`);
  for (var i=0;i<rows.length;i++)
  {
    if (i > 0)
    {
      var cols = rows[i].split(",");
      lightBaseMap.set(cols[0], cols);
    }
  }
}

function loadCsvData()
{
  var csvData = `BaseId,x,z,DistFromCtr,Theta
  0,180.0004,0,180.0004,90
  1,164.4385,73.21274,180.0004,66
  2,120.4437,133.7663,180.0004,42
  3,55.62317,171.1905,180.0004,18.00001
  4,-18.81517,179.0143,180.0004,5.999989
  5,-90.00018,155.8849,180.0004,29.99999
  6,-145.6234,105.8015,180.0004,54.00001
  7,-176.0669,37.42417,180.0003,78
  8,-176.0669,-37.42419,180.0003,102
  9,-145.6233,-105.8016,180.0004,126
  10,-90.00014,-155.8849,180.0003,150
  11,-18.81514,-179.0143,180.0004,174
  12,55.62319,-171.1905,180.0004,162
  13,120.4438,-133.7663,180.0004,138
  14,164.4385,-73.21272,180.0004,114
  15,-226.6909,466.6914,518.8348,25.90773
  16,-238.4373,540.8556,591.0813,23.79038
  17,-272.5269,607.7601,666.0656,24.15204
  18,-325.6227,660.8558,736.7228,26.23079
  19,-392.5271,694.9454,798.1395,29.45914
  20,-466.6914,706.6917,846.8849,33.44033
  21,-540.8556,694.9454,880.6099,37.89258
  22,-607.7601,660.8558,897.8323,42.60338
  23,-660.8558,607.7601,897.8323,47.39662
  24,-694.9454,540.8555,880.6099,52.10743
  25,-706.6917,466.6913,846.8848,56.55967
  26,-694.9454,392.5271,798.1395,60.54087
  27,-660.8557,325.6225,736.7227,63.76921
  28,-607.7601,272.5268,666.0654,65.84797
  29,-540.8553,238.4373,591.0811,66.20961
  30,-466.6912,226.6909,518.8347,64.09226
  31,-392.5269,238.4374,459.2709,58.72373
  32,-325.6224,272.527,424.6186,50.07262
  33,-272.5267,325.6229,424.6187,39.9273
  34,-238.4372,392.5275,459.2713,31.27621
  35,706.692,-466.6912,846.8851,123.4403
  36,694.9454,-392.527,798.1395,119.4591
  37,660.856,-325.6225,736.723,116.2308
  38,607.7603,-272.5267,666.0656,114.152
  39,540.8557,-238.4371,591.0814,113.7904
  40,466.6915,-226.6907,518.8349,115.9077
  41,392.5273,-238.4372,459.2711,121.2762
  42,325.6228,-272.5267,424.6187,129.9273
  43,272.527,-325.6225,424.6186,140.0726
  44,238.4375,-392.527,459.271,148.7237
  45,226.6911,-466.6913,518.8348,154.0923
  46,238.4375,-540.8555,591.0813,156.2096
  47,272.5271,-607.7601,666.0656,155.8479
  48,325.623,-660.8557,736.7228,153.7692
  49,392.5275,-694.9454,798.1396,150.5408
  50,466.6918,-706.6917,846.8851,146.5597
  51,540.856,-694.9451,880.6099,142.1074
  52,607.7606,-660.8554,897.8323,137.3966
  53,660.8561,-607.7597,897.8322,132.6034
  54,694.9457,-540.855,880.6099,127.8925
  55,-79.56292,-221.2081,235.0814,160.2176
  56,211.9862,111.4152,239.4818,62.2746
  57,-235.7658,62.1479,243.8194,75.23273
  58,134.1799,-208.6819,248.0975,147.2595
  59,42.7376,248.6737,252.3194,9.751711
  60,-202.7857,-157.0477,256.4879,127.7561
  61,259.7155,-21.51757,260.6053,94.73618
  62,-179.7345,194.2886,264.6744,42.77161
  63,1.310173,-268.6942,268.6974,179.7209
  64,183.2075,201.9586,272.6761,42.21285
  65,-275.4323,-25.52647,276.6127,95.29492
  66,223.4417,-169.5849,280.5089,127.1973
  67,-50.89647,279.7747,284.3665,10.31048
  68,-153.4904,-243.9108,288.1871,147.8182
  69,281.5888,77.17142,291.9721,74.67399
  70,-263.1005,135.0192,295.7229,62.83379
  71,104.0904,-280.767,299.441,159.6584
  72,114.2922,280.7553,303.1275,22.15066
  73,-277.2268,-131.3827,306.7835,115.3571
  74,296.632,-91.45498,310.4102,107.1351
  75,-158.7698,270.9127,314.0088,30.37265
  76,-66.67681,-310.5018,317.5802,167.8804
  77,261.7964,185.9678,321.1252,54.6118
  78,-322.1526,40.14928,324.6449,82.89597
  79,212.6904,-249.8774,328.1401,139.5963
  80,12.0849,331.3913,331.6116,2.088535
  81,-235.1814,-238.6525,335.0601,135.4197
  82,338.0447,17.28723,338.4864,87.07251
  83,-263.5659,217.7675,341.8913,50.43527
  84,47.71309,-341.9627,345.2753,172.0569
  85,197.718,287.1531,348.6393,34.54919
  86,-343.0206,-78.9259,351.9835,102.9577
  87,309.1396,-175.1488,355.3089,119.5345
  88,-110.6592,341.1157,358.6159,17.97324
  89,-150.1886,-329.2697,361.9049,155.481
  90,336.1748,142.6202,365.1767,67.01121
  91,-347.2914,123.0058,368.4315,70.49657
  92,174.5134,-328.1519,371.67,151.9957
  93,93.78887,362.9713,374.8927,14.48788
  94,-317.0297,-206.038,378.0998,123.0199
  95,376.0932,-62.74976,381.292,99.47234
  96,-30.12188,-386.4606,387.6327,175.5432
  97,285.5627,266.7669,390.7821,46.94902
  98,-393.8993,-3.841457,393.918,90.55875
  99,-38.86922,398.2585,400.1508,5.574326
  100,-242.2193,-322.3957,403.2482,143.0821
  101,399.4129,74.67483,406.3336,79.41016
  102,110.9585,-397.2644,412.4691,164.3946
  103,187.9105,370.6028,415.5199,26.88684
  104,-391.743,-147.4099,418.5597,110.6209
  105,391.244,-157.0515,421.5887,111.8713
  106,-123.9928,-409.2445,427.6158,163.1442
  107,370.4486,219.537,430.6142,59.34797
  108,-424.3775,88.96793,433.603,78.1598
  109,52.23259,436.4379,439.5524,6.82464
  110,-335.5697,-288.4635,442.5135,130.6831
  111,445.2436,-14.06323,445.4656,91.80911
  112,25.24532,-450.638,451.3445,176.7936
  113,287.6397,351.6048,454.2715,39.2858
  114,-452.4912,-65.38215,457.1905,98.22198
  115,-106.0228,450.7026,463.005,13.23752
  116,-227.6825,-406.478,465.9009,150.7453
  117,445.2012,146.8318,468.7896,71.74693
  118,157.1911,450.7929,477.4132,19.22362
  119,-422.9334,-227.5754,480.2741,118.2842
  120,468.3499,-118.5809,483.1284,104.2081
  121,-78.08989,-482.5404,488.8182,170.8075
  122,385.7573,304.8195,491.6539,51.68475
  123,-493.1702,36.01694,494.4837,85.82302
  124,-7.327076,500.0718,500.1255,0.8395343
  125,-334.26,-375.7883,502.938,138.3472
  126,503.1068,51.59156,505.7451,84.14501
  127,96.4344,-502.1676,511.3432,169.1295
  128,269.5651,437.8003,514.1346,31.6217
  129,-497.1786,-141.4944,516.921,105.8861
  130,-193.2926,-488.3919,525.2511,158.4077
  131,474.921,230.7672,528.0184,64.08458
  132,-508.7211,151.4322,530.7814,73.42319
  133,107.4817,525.4133,536.2942,11.56127
  134,-436.3916,-316.435,539.0443,125.9465
  135,538.2584,-61.76192,541.7902,96.54572
  136,-14.61397,-547.075,547.2701,178.4698
  137,382.2198,395.4906,550.0044,44.0224
  138,-551.7124,-33.60279,552.7348,93.48537
  139,-82.5138,552.0523,558.1848,8.500919
  140,-313.5833,-465.0585,560.9045,146.0087
  141,548.01,131.7321,563.6207,76.48354
  142,232.1889,522.4809,571.7499,23.96023
  143,-526.6177,-229.4998,574.4531,113.5476
  144,-140.2311,-565.415,582.5452,166.0709
  145,487.5768,323.6833,585.2367,56.42136
  146,-580.8253,91.09589,587.9255,81.08642
  147,40.33287,591.9224,593.2949,3.898074
  148,-431.519,-411.0698,595.9757,133.6097
  149,598.5402,11.6755,598.6541,88.88249
  150,64.53027,-600.5463,604.0033,173.8669
  151,359.6639,488.5647,606.6742,36.35917
  152,-597.8444,-117.819,609.3433,101.1486
  153,-171.1191,590.3749,614.6741,16.16414
  154,-273.7952,-553.2995,617.3363,153.6719
  155,578.117,224.001,619.9965,68.82032
  156,176.2173,602.7336,627.9652,16.297
  157,-539.3464,-326.7784,630.6177,121.2108
  158,621.0323,-123.8854,633.2683,101.2815
  159,-69.69471,-634.7496,638.5643,173.7341
  160,482.1471,422.7106,641.2098,48.75813
  161,-643.7004,14.04964,643.8538,88.74964
  162,-42.62725,647.7357,649.1368,3.7652
  163,-407.7583,-508.4736,651.7762,141.273
  164,646.7443,99.89858,654.4141,81.21927
  165,157.3155,-640.6536,659.6857,166.2037
  166,318.0204,580.9736,662.3196,28.69595
  167,-629.4323,-214.4211,664.9522,108.8118
  168,-215.3312,-637.4557,672.8428,161.3351
  169,591.6757,325.8537,675.4707,61.15709
  170,-658.9468,160.0165,678.0975,76.35069
  171,102.583,675.6046,683.3483,8.633789
  172,-534.0485,-430.5229,685.9722,128.874
  173,687.2227,-43.45587,688.5953,93.61823
  174,16.91953,-693.6321,693.8384,178.6026
  175,457.7882,524.8666,696.4589,41.09491
  176,-694.7044,-78.08154,699.0786,96.41286
  177,-139.5555,690.3514,704.3159,11.42841
  178,-364.7723,-605.5544,706.9335,148.9362
  179,680.5278,200.8576,709.5504,73.55605
  180,257.4748,669.6014,717.3976,21.03273
  181,-644.5037,-320.9872,720.0123,116.4751
  182,694.5734,-199.3912,722.6265,106.0172
  183,-138.9015,-714.4769,727.8536,168.9984
  184,587.1442,434.5611,730.4667,53.49387
  185,-729.082,76.45068,733.0793,84.01391
  186,12.5057,738.1975,738.3035,0.9707584
  187,-509.6631,-537.7721,740.9152,136.5372
  188,741.6744,52.4483,743.5266,85.955
  189,117.9115,-739.4065,748.7491,170.9395
  190,413.9559,627.0424,751.3599,33.43168
  191,-731.3317,-183.3734,753.9707,104.0761
  192,-248.3164,717.4338,759.1919,19.09164
  193,-302.5555,-699.1445,761.8023,156.5994
  194,697.7432,312.2205,764.4129,65.89282
  195,-727.8734,241.9203,767.0235,71.61496
  196,178.5661,751.3158,772.2443,13.36949
  197,-641.3364,-434.8424,774.855,124.1383
  198,769.2164,-112.9565,777.4658,98.35396
  199,-45.55465,-781.3607,782.6875,176.6633
  200,563.2649,547.1988,785.2985,45.82889
  201,-787.5717,-23.08403,787.9099,91.67889
  202,-92.45882,787.7256,793.1332,6.694422
  203,-465.4525,-645.418,795.7452,144.2022
  204,781.7416,162.0328,798.3574,78.29002
  205,231.2608,-769.587,803.5831,163.2745
  206,350.4599,726.0375,806.1964,25.7667
  207,-751.277,-299.5934,808.8099,111.7411
  208,758.7853,-287.4957,811.424,110.7512
  209,-221.4755,-786.0478,816.6533,164.2644
  210,696.5,431.3798,819.2684,58.22785
  211,-807.5404,152.8794,821.8842,79.27992
  212,82.21416,823.0211,827.1172,5.704545
  213,-618.5161,-553.0801,829.7347,131.8032
  214,832.2917,-10.05964,832.3525,90.69248
  215,63.13763,-835.2068,837.5899,175.6769
  216,519.2372,660.564,840.2095,38.16917
  217,-831.6594,-136.765,842.8298,99.33862
  218,-210.2497,821.597,848.0723,14.35416
  219,-401.1858,-750.1542,850.6946,151.8619
  220,805.0182,283.0133,853.3176,70.63029
  221,-787.181,336.1271,855.9412,66.87747
  222,354.4759,-781.973,858.5656,155.6148
  223,267.6514,818.5427,861.1906,18.10698
  224,-752.5632,-424.0612,863.8166,119.4008
  225,843.9243,-196.2544,866.4434,103.0914
  226,-122.4604,-863.0544,871.6992,171.9241
  227,675.314,555.3388,874.3284,50.56812
  228,-875.7078,46.81884,876.9584,86.93965
  229,-30.09963,881.7075,882.2211,1.955247
  230,-575.1014,-672.4766,884.8539,139.463
  231,880.9274,107.7077,887.4874,83.02926
  232,185.4058,-873.2931,892.7576,168.0137
  233,454.5269,771.4507,895.3942,30.50594
  234,-858.7834,-262.5865,898.0316,107.0018
  235,812.9966,-387.6122,900.6702,115.4904
  236,-338.6399,837.4316,903.3099,22.01738
  237,-316.8979,-848.7176,905.9503,159.5251
  238,809.3242,412.9572,908.592,62.96708
  239,-878.2661,242.8931,911.2346,74.5407
  240,484.9372,-774.6028,913.8783,147.9515
  241,166.1384,901.3393,916.5231,10.44376
  242,-733.4624,-553.9896,919.1689,127.064
  243,917.6823,-87.20245,921.8162,95.42822
  244,-6.677406,-927.0897,927.1138,179.5874
  245,632.9681,681.038,929.7642,42.9049
  246,-929.4089,-74.82542,932.416,94.60287
  247,-156.6802,924.5408,937.723,9.618402
  248,-510.4285,-789.7938,940.3784,147.1262
  249,912.4424,238.2512,943.0349,75.36604
  250,-836.093,441.9088,945.6928,62.14175
  251,318.8981,-893.1266,948.3519,160.3505
  252,369.1856,876.4282,951.0123,22.84272
  253,-866.6635,-397.9804,953.674,114.6651
  254,910.4177,-292.7795,956.337,107.8272
  255,-474.8634,833.1795,959.0012,29.6806
  256,-213.2461,-937.7256,961.6669,167.1884
  257,792.8583,548.9223,964.3339,55.30385
  258,-958.0644,131.1717,967.0023,82.20393
  259,619.5475,-745.9388,969.672,140.2883
  260,47.16879,971.1984,972.3431,2.780589
  261,-692.7146,-686.1501,975.0157,134.7272
  262,976.9459,38.12833,977.6897,87.76499
  263,-748.1666,633.5314,980.3649,49.74279
  264,124.0683,-975.1812,983.0418,172.7495
  265,568.7865,805.0624,985.7198,35.24167
  266,-965.8358,-209.9877,988.3995,102.2661
  267,856.3387,-498.9239,991.0807,120.2261
  268,-295.2163,948.9009,993.7633,17.28164
  269,-424.4331,-901.5342,996.4473,154.7894
  270,924.4263,379.0819,999.1332,67.70281
  271,-940.2313,345.8452,1001.82,69.80496
  272,460.916,-892.5216,1004.509,152.6873
  273,263.7288,972.0585,1007.199,15.17949
  274,-853.3558,-540.059,1009.891,122.3283
  275,996.6937,-178.6861,1012.584,100.1639
  276,-615.8652,807.157,1015.279,37.34383
  277,-91.34873,-1013.869,1017.976,174.8516
  278,754.21,687.7083,1020.674,47.64063
  279,754.9869,-694.8561,1026.075,132.6251
  280,-87.56538,1025.045,1028.778,4.882707
  281,-629.4904,-817.1284,1031.483,142.3905
  282,1018.795,177.7758,1034.189,80.10177
  283,-873.5951,558.5585,1036.897,57.406
  284,267.5587,-1004.587,1039.607,165.0862
  285,482.5544,923.8878,1042.318,27.57845
  286,-982.4485,-356.2103,1045.031,109.9293
  287,967.5504,-402.0175,1047.746,112.5629
  288,-443.0285,952.4692,1050.463,24.94487
  289,-317.5277,-1004.174,1053.181,162.4527
  290,914.8016,527.3185,1055.901,60.03959
  291,-1033.402,229.7017,1058.623,77.46819
  292,608.3984,-869.6594,1061.346,145.024
  293,139.1887,1054.929,1064.072,7.516273
  294,-817.3168,-685.6039,1066.799,129.9915
  295,-758.2944,758.1078,1072.258,45.00705
  296,692.4225,825.8584,1077.725,39.9774
  297,-1071.143,-141.5963,1080.461,97.53037
  298,887.7184,-620.7069,1083.199,124.9619
  299,-235.8898,1060.01,1085.939,12.54593
  300,-543.4568,-943.3351,1088.681,150.0537
  301,1040.557,329.3141,1091.425,72.43855
  302,-992.2131,461.2177,1094.17,65.06924
  303,421.1339,-1012.855,1096.918,157.423
  304,374.5789,1033.905,1099.667,19.91523
  305,-977.0336,-510.619,1102.418,117.5926
  306,1068.013,-284.1699,1105.172,104.8997
  307,-597.0505,933.2913,1107.927,32.60809
  308,-190.6559,-1094.198,1110.684,170.1159
  309,881.889,679.7257,1113.443,52.37637
  310,-1112.177,94.73295,1116.204,85.13142
  311,757.9651,-823.15,1118.967,137.3608
  312,-757.4588,-831.1162,1124.499,137.6547
  313,1122.695,101.4325,1127.268,84.83749
  314,-898.5609,685.2567,1130.039,52.67029
  315,200.1766,-1114.985,1132.812,169.8219
  316,607.0413,959.7181,1135.587,32.31419
  317,-1098.573,-298.344,1138.364,105.1936
  318,1014.052,-523.3607,1141.143,117.2986
  319,-395.1663,1073.502,1143.924,20.20914
  320,-434.8122,-1061.073,1146.708,157.7169
  321,1039.882,489.8786,1149.493,64.77531
  322,-1100.346,342.0361,1152.281,72.73245
  323,581.7242,-997.89,1155.07,149.7598
  324,245.7119,1131.49,1157.862,12.252
  325,-947.7723,-669.9624,1160.656,125.2558
  326,1154.185,-146.5535,1163.452,97.23645
  327,-753.873,889.8392,1166.25,40.27132
  328,-45.30353,-1168.172,1169.05,177.7791
  329,824.4657,832.7631,1171.852,44.71313
  330,-1173.26,-57.27192,1174.657,92.79464
  331,905.9716,-752.0878,1177.464,129.6976
  332,-160.3892,1169.324,1180.272,7.810173
  333,-673.2003,-972.876,1183.083,145.318
  334,1156.308,263.2528,1185.897,77.17427
  335,-1032.897,588.3539,1188.712,60.33349
  336,365.0622,-1134.228,1191.53,162.1587
  337,498.1504,1085.503,1194.35,24.65095
  338,-1103.168,-465.0169,1197.172,112.8568
  339,1130.216,-403.2391,1199.996,109.6354
  340,-562.3239,1063.285,1202.823,27.87237
  341,-304.3123,-1166.615,1205.651,165.3801
  342,1014.805,656.2028,1208.483,57.11209
  343,-1194.338,202.0996,1211.316,80.39568
  344,745.8931,-958.0227,1214.152,142.0965
  345,97.36354,1213.089,1216.99,4.588768
  346,-893.3024,-830.6599,1219.83,132.919
  347,1222.639,9.107087,1222.672,89.57323
  348,-909.7994,821.071,1225.517,47.93454
  349,116.5025,-1222.827,1228.365,174.5577
  350,741.8195,982.6454,1231.214,37.04991
  351,-1213.566,-223.9981,1234.066,100.4579
  352,1048.574,-656.0967,1236.92,122.0344
  353,-330.7613,1194.84,1239.777,15.47341
  354,-564.5084,-1107.011,1242.635,152.9812
  355,1166.706,435.9572,1245.497,69.51105
  356,-1157.433,467.7102,1248.36,67.99673
  357,538.7554,-1129.296,1251.226,154.4955
  358,366.405,1199.375,1254.095,16.98772
  359,-1082.815,-638.3371,1256.966,120.52
  360,1232.435,-261.3369,1259.839,101.9722
  361,-733.9003,1027.54,1262.714,35.53558
  362,-153.2863,-1256.276,1265.593,173.0434
  363,963.819,824.6678,1268.473,49.44887
  364,-1270.627,43.06338,1271.356,88.05891
  365,909.8922,-892.0693,1274.242,134.4333
  366,-68.49699,1275.291,1277.129,3.074407
  367,-812.7744,-988.8621,1280.02,140.5822
  368,1270.145,180.5422,1282.912,81.91
  369,-1060.909,726.4802,1285.808,55.59777
  370,292.2082,-1255.14,1288.705,166.8945
  371,633.7926,1125.412,1291.606,29.38668
  372,-1230.303,-402.6261,1294.509,108.1211
  373,1181.803,-535.3721,1297.414,114.3711
  374,-510.9289,1195.737,1300.321,23.13663
  375,-431.9302,-1229.573,1303.232,160.6444
  376,1151.625,616.2587,1306.145,61.84783
  377,-1268.273,324.2231,1309.06,75.65995
  378,717.7723,-1098.221,1311.978,146.8323
  379,213.0476,1297.524,1314.899,9.324513
  380,-1035.857,-814.6494,1317.821,128.1833
  381,1317.014,-99.23388,1320.747,94.30896
  382,-906.0981,964.9366,1323.675,43.19881
  383,16.35962,-1326.505,1326.606,179.2934
  384,885.933,991.3618,1329.54,41.78565
  385,-1325.836,-132.8532,1332.475,95.72213
  386,1069.725,-799.3863,1335.414,126.7701
  387,-249.3526,1314.921,1338.355,10.73768
  388,-705.9008,-1140.521,1341.299,148.2455
  389,1293.756,364.9554,1344.246,74.24678
  390,-1203.133,606.1394,1347.194,63.26099
  391,478.7581,-1262.412,1350.146,159.2312
  392,500.8192,1257.005,1353.1,21.72346
  393,-1221.046,-589.8641,1356.057,115.7843
  394,1301.643,-390.7077,1359.017,106.7079
  395,-697.3891,1169.888,1361.98,30.79986
  396,-276.6154,-1336.622,1364.945,168.3076
  397,1109.249,800.4691,1367.912,54.18459
  398,-1361.595,159.3081,1370.883,83.32667
  399,898.2672,-1039.517,1373.856,139.1691
  400,39.83138,1376.255,1376.831,1.657766
  401,-961.1526,-989.9808,1379.81,135.8465
  402,1380.417,80.99073,1382.791,86.64224
  403,-1074.847,874.6876,1385.776,50.86204
  404,202.2345,-1373.958,1388.762,171.6267
  405,780.721,1152.149,1391.752,34.12242
  406,-1356.836,-322.9649,1394.744,103.3889
  407,1221.224,-679.9162,1397.739,119.1069
  408,-442.2431,1329.091,1400.736,18.4044
  409,-572.9946,-1281.466,1403.737,155.9087
  410,1290.848,559.1334,1406.74,66.58006
  411,-1332.333,460.7311,1409.746,70.92422
  412,672.7103,-1242.312,1412.755,151.5645
  413,343.949,1373.352,1415.767,14.06025
  414,-1183.771,-782.0664,1418.781,123.451
  415,1404.12,-223.5136,1421.798,99.04469
  416,1068.51,-46.6656,1069.528,92.50072
  417,-1023.372,2.372952,1023.374,89.86715
  418,47.16833,-1073.956,1074.991,177.4852
  419,-2.877141,1121.729,1121.732,0.1467098`;
  return csvData;
}

// This file holds the main code for the plugins. It has access to the *document*.
// You can access browser APIs such as the network by creating a UI which contains
// a full browser environment (see documentation).

(async() => {
  await loadFonts();

  buildMap();

  const nodes: SceneNode[] = [];
  const node = figma.currentPage;
  const base = node.findOne(node => node.type === "COMPONENT" && node.name === "Light Base") as ComponentNode;
  const lights = node.findOne(node => node.type === "GROUP" && node.name === "Lights") as FrameNode;

  var testLoopMax = 500;
  for (let key of lightBaseMap.keys()) {
    const light = base.createInstance();
    console.log(`processing lightbase ${key}`);
    console.log(`    ${lightBaseMap.get(key)}`);
    console.log(`    ${lightBaseMap.get(key)[1]}`);
    console.log(`    ${lightBaseMap.get(key)[2]}`);

    light.x = parseFloat(lightBaseMap.get(key)[1]);
    light.y = parseFloat(lightBaseMap.get(key)[2]);
    const id = light.findOne(node => node.type === "TEXT" && node.name === "#ID") as TextNode;
    id.characters = key;

    lights.appendChild(light);
    nodes.push(light);

    testLoopMax -=1;
    if (testLoopMax == 0)
      break;
  }
  figma.currentPage.selection = nodes;
  figma.viewport.scrollAndZoomIntoView(nodes);

  // Make sure to close the plugin when you're done. Otherwise the plugin will
  // keep running, which shows the cancel button at the bottom of the screen.
  figma.closePlugin();

})();


